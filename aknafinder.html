<!doctype html>
<html lang="hu">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Aknakeres≈ë (Minesweeper) ‚Äî Egylapos</title>
  <style>
    :root{
      --bg:#121212; --card:#1e1e1e; --accent:#ffcb05; --text:#eaeaea;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, sans-serif;background:linear-gradient(180deg,#0f1720 0%, #071025 100%);color:var(--text)}
    .app{max-width:920px;margin:28px auto;padding:20px;background:rgba(255,255,255,0.02);border-radius:12px;box-shadow:0 6px 30px rgba(2,6,23,0.6)}
    header{display:flex;gap:16px;align-items:center;justify-content:space-between}
    h1{margin:0;font-size:20px}
    .controls{display:flex;gap:8px;align-items:center}
    button, select{background:var(--card);border:1px solid rgba(255,255,255,0.04);color:var(--text);padding:8px 10px;border-radius:8px;cursor:pointer}
    .meta{display:flex;gap:12px;align-items:center}
    .display{min-width:68px;text-align:center;padding:8px;border-radius:8px;background:#111827;border:1px solid rgba(255,255,255,0.03)}

    main{display:flex;gap:20px;margin-top:18px}
    .left{flex:1}
    .board-wrap{background:rgba(255,255,255,0.02);padding:16px;border-radius:10px}
    #board{display:grid;gap:6px;user-select:none}
    .cell{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:#0b1220;border-radius:6px;box-shadow:inset 0 -2px 0 rgba(255,255,255,0.02);font-weight:700;color:var(--text);cursor:pointer}
    .cell.revealed{background:linear-gradient(180deg,#e6e7ea,#d8d9db);color:#111;border:1px solid rgba(0,0,0,0.06);box-shadow:none;cursor:default}
    .cell.mine{background:linear-gradient(180deg,#ff6b6b,#ff3b3b);color:#fff}
    .cell.flag{background:#0b1220;color:#ffcb05}
    .cell.number-1{color:#2b6eff}
    .cell.number-2{color:#0fa67a}
    .cell.number-3{color:#ff6b6b}
    .cell.number-4{color:#6b3bff}
    .cell.number-5{color:#c94b00}
    .cell.number-6{color:#1f7a7a}
    .cell.number-7{color:#111}
    .cell.number-8{color:#777}

    .sidebar{width:240px}
    .legend{background:rgba(255,255,255,0.02);padding:12px;border-radius:10px}
    small{color:#9aa3b2}
    footer{margin-top:18px;text-align:center;color:#9aa3b2;font-size:13px}

    @media (max-width:720px){.app{margin:8px;padding:12px}.sidebar{display:none}.cell{width:30px;height:30px}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div>
        <h1>Aknakeres≈ë ‚Äî HTML/JS</h1>
        <small>Bal katt: felt√°r√°s ‚Ä¢ Jobb katt: z√°szl√≥</small>
      </div>
      <div class="controls">
        <div class="meta">
          <div class="display" id="mineCounter">0</div>
          <div class="display" id="timer">0:00</div>
        </div>
        <select id="difficulty">
          <option value="easy">K√∂nny≈± (9√ó9, 10 akna)</option>
          <option value="medium">K√∂zepes (16√ó16, 40 akna)</option>
          <option value="hard">Neh√©z (16√ó30, 99 akna)</option>
          <option value="custom">Egyedi</option>
        </select>
        <button id="newBtn">√öj j√°t√©k</button>
      </div>
    </header>

    <main>
      <div class="left">
        <div class="board-wrap">
          <div id="board"></div>
        </div>
      </div>
      <aside class="sidebar">
        <div class="legend">
          <h3>√ötmutat√≥</h3>
          <p><small>√Åll√≠tsd be a neh√©zs√©get, majd kattints az "√öj j√°t√©k" gombra. A c√©l az √∂sszes nem-akn√°s mez≈ë felt√°r√°sa. Z√°szl√≥: jobb katt vagy hossz√∫ nyom√°s mobilon.</small></p>
          <hr />
          <p><strong>St√°tusz:</strong> <span id="status">K√©szen</span></p>
          <p><strong>Tippek:</strong></p>
          <ul>
            <li>T√∂ltsd ki a sarkokat el≈ësz√∂r ‚Äî gyakran √ºres ter√ºleteket tal√°lsz.</li>
            <li>Ha m√°r minden sz√°mozott mez≈ë k√∂r√ºl megegyezik a z√°szl√≥k sz√°ma √©s a sz√°m, kattints gyorsan a sz√°mra a k√∂rny√©k felt√°r√°s√°hoz.</li>
          </ul>
        </div>
      </aside>
    </main>

    <footer>
      K√©sz√ºlt HTML/JS-ben ‚Äî k√©rsz extra funkci√≥kat (hang, leaderboard, export)?
    </footer>
  </div>

<script>
(() => {
  const boardEl = document.getElementById('board');
  const newBtn = document.getElementById('newBtn');
  const difficulty = document.getElementById('difficulty');
  const mineCounter = document.getElementById('mineCounter');
  const timerEl = document.getElementById('timer');
  const statusEl = document.getElementById('status');

  let rows=9, cols=9, mines=10;
  let grid = [];
  let started=false, interval=null, startTime=0, flags=0, revealedCount=0, totalCells=0;
  let touchHoldTimer=null;

  function setDifficulty(val){
    if(val==='easy'){rows=9;cols=9;mines=10}
    else if(val==='medium'){rows=16;cols=16;mines=40}
    else if(val==='hard'){rows=16;cols=30;mines=99}
    else { //custom minimal handling: ask prompt
      const r = prompt('Sorok (pl. 10)', '10');
      const c = prompt('Oszlopok (pl. 10)', '10');
      const m = prompt('Akna sz√°m', '15');
      rows = Math.max(5, Math.min(50, parseInt(r)||10));
      cols = Math.max(5, Math.min(50, parseInt(c)||10));
      mines = Math.max(1, Math.min(rows*cols-1, parseInt(m)||15));
    }
  }

  function formatTime(seconds){
    const m = Math.floor(seconds/60);
    const s = seconds%60;
    return `${m}:${s.toString().padStart(2,'0')}`;
  }

  function startTimer(){
    startTime = Date.now();
    interval = setInterval(()=>{
      const s = Math.floor((Date.now()-startTime)/1000);
      timerEl.textContent = formatTime(s);
    }, 250);
  }

  function stopTimer(){
    clearInterval(interval); interval=null;
  }

  function placeMines(firstR, firstC){
    const cells = [];
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++){
      if(r===firstR && c===firstC) continue; // avoid first click
      cells.push([r,c]);
    }
    // shuffle and pick mines
    for(let i=cells.length-1;i>0;i--){
      const j=Math.floor(Math.random()*(i+1));
      [cells[i],cells[j]]=[cells[j],cells[i]];
    }
    for(let i=0;i<mines;i++){
      const [r,c]=cells[i];
      grid[r][c].mine=true;
    }
    // compute numbers
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++){
      if(grid[r][c].mine) continue;
      let cnt=0;
      for(let dr=-1;dr<=1;dr++) for(let dc=-1;dc<=1;dc++){
        const nr=r+dr, nc=c+dc;
        if(nr>=0 && nr<rows && nc>=0 && nc<cols && grid[nr][nc].mine) cnt++;
      }
      grid[r][c].num = cnt;
    }
  }

  function buildBoard(){
    boardEl.innerHTML='';
    boardEl.style.gridTemplateColumns = `repeat(${cols}, auto)`;
    grid = Array.from({length:rows}, ()=>Array.from({length:cols}, ()=>({revealed:false,mine:false,flag:false,num:0,el:null})));

    totalCells = rows*cols;
    revealedCount = 0; flags = 0; started=false; stopTimer(); timerEl.textContent='0:00';
    mineCounter.textContent = mines;
    statusEl.textContent='K√©szen';

    for(let r=0;r<rows;r++){
      for(let c=0;c<cols;c++){
        const cell = document.createElement('div');
        cell.className='cell';
        cell.dataset.r=r; cell.dataset.c=c;
        grid[r][c].el = cell;

        // left click
        cell.addEventListener('click', (e)=>{
          e.preventDefault();
          openCell(r,c);
        });
        // right click -> flag
        cell.addEventListener('contextmenu', (e)=>{
          e.preventDefault();
          toggleFlag(r,c);
        });
        // mobile: long press to flag
        cell.addEventListener('touchstart', (e)=>{
          touchHoldTimer = setTimeout(()=>{ toggleFlag(r,c); touchHoldTimer=null; }, 600);
        });
        cell.addEventListener('touchend', (e)=>{ if(touchHoldTimer){ clearTimeout(touchHoldTimer); touchHoldTimer=null; } });

        boardEl.appendChild(cell);
      }
    }
  }

  function revealAllMines(){
    for(let r=0;r<rows;r++) for(let c=0;c<cols;c++){
      if(grid[r][c].mine){
        grid[r][c].el.classList.add('revealed','mine');
        grid[r][c].revealed = true;
      }
    }
  }

  function gameOver(win){
    started=false; stopTimer();
    if(!win){ revealAllMines(); statusEl.textContent='Vesz√≠tett√©l :('; }
    else { statusEl.textContent='Nyert√©l! üéâ'; }
  }

  function toggleFlag(r,c){
    const cell = grid[r][c];
    if(cell.revealed) return;
    cell.flag = !cell.flag;
    if(cell.flag){ cell.el.classList.add('flag'); flags++; }
    else { cell.el.classList.remove('flag'); flags--; }
    mineCounter.textContent = mines - flags;
  }

  function openCell(r,c){
    const cell = grid[r][c];
    if(cell.revealed || cell.flag) return;
    if(!started){ // first click
      placeMines(r,c);
      started=true; startTimer(); statusEl.textContent='J√°t√©k folyamatban';
    }
    if(cell.mine){
      cell.el.classList.add('revealed','mine');
      cell.revealed=true;
      gameOver(false);
      return;
    }
    floodReveal(r,c);
    checkWin();
  }

  function floodReveal(r,c){
    const stack = [[r,c]];
    while(stack.length){
      const [cr,cc] = stack.pop();
      const cell = grid[cr][cc];
      if(cell.revealed || cell.flag) continue;
      cell.revealed = true; cell.el.classList.add('revealed');
      revealedCount++;
      if(cell.num>0){
        cell.el.textContent = cell.num;
        cell.el.classList.add('number-'+cell.num);
      } else {
        // expand neighbors
        for(let dr=-1;dr<=1;dr++) for(let dc=-1;dc<=1;dc++){
          const nr=cr+dr, nc=cc+dc;
          if(nr>=0 && nr<rows && nc>=0 && nc<cols){
            const ncell = grid[nr][nc];
            if(!ncell.revealed && !ncell.mine) stack.push([nr,nc]);
          }
        }
      }
    }
  }

  // quick open neighbors if flags equal number
  boardEl.addEventListener('dblclick', (e)=>{
    const el = e.target.closest('.cell'); if(!el) return;
    const r = parseInt(el.dataset.r), c = parseInt(el.dataset.c);
    const cell = grid[r][c]; if(!cell.revealed || cell.num===0) return;
    // count flags
    let flagCount=0, toOpen=[];
    for(let dr=-1;dr<=1;dr++) for(let dc=-1;dc<=1;dc++){
      const nr=r+dr, nc=c+dc;
      if(nr>=0 && nr<rows && nc>=0 && nc<cols){
        if(grid[nr][nc].flag) flagCount++;
        else if(!grid[nr][nc].revealed) toOpen.push([nr,nc]);
      }
    }
    if(flagCount===cell.num){
      for(const [nr,nc] of toOpen) openCell(nr,nc);
    }
  });

  function checkWin(){
    if(revealedCount === totalCells - mines){
      gameOver(true);
    }
  }

  newBtn.addEventListener('click', ()=>{
    setDifficulty(difficulty.value);
    buildBoard();
  });

  // init
  setDifficulty(difficulty.value);
  buildBoard();

  // prevent context menu on board for nicer UX
  boardEl.addEventListener('contextmenu', (e)=>e.preventDefault());

})();
</script>
</body>
</html>